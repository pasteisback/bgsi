<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <title>BGSI Codes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary px-3">
        <a class="navbar-brand" href="#">BGSI Secrets</a>
        <div class="ms-auto d-flex gap-2">
            <a class="btn btn-light btn-sm" href="https://bgsi.gg" target="_blank">Official Site</a>
            <a class="btn btn-light btn-sm" href="https://www.roblox.com/games/17081878951/" target="_blank">Play Game</a>
            <button class="btn btn-sm btn-warning" onclick="toggleTheme()">Toggle Theme</button>
        </div>
    </nav>

    <div class="container mt-4">
        <ul class="nav nav-tabs" id="sourceTabs"></ul>
        <div id="codesContainer" class="row mt-3 g-3"></div>
    </div>

    <script src="codes.js"></script>
    <script>
        const themes = {
            dark: {
                '--bg': '#111', '--fg': '#fff', '--card-bg': '#222', '--card-hover': '#333'
            },
            light: {
                '--bg': '#fff', '--fg': '#000', '--card-bg': '#f0f0f0', '--card-hover': '#e0e0e0'
            }
        };

        function toggleTheme() {
            const html = document.documentElement;
            const newTheme = html.getAttribute("data-theme") === "dark" ? "light" : "dark";
            html.setAttribute("data-theme", newTheme);
            localStorage.setItem("theme", newTheme);
            applyTheme(newTheme);
        }

        function applyTheme(theme) {
            const root = document.documentElement;
            Object.entries(themes[theme]).forEach(([key, val]) => {
                root.style.setProperty(key, val);
            });
        }

        function groupCodesBySource() {
            const groups = {};
            codes.forEach(c => {
                if (!groups[c.source]) groups[c.source] = [];
                groups[c.source].push(c);
            });
            return groups;
        }

        function createCodeCard(code, reward) {
            return `
                <div class="col-md-4 animate">
                    <div class="code-card p-3 rounded shadow-sm">
                        <h5>${code}</h5>
                        <p class="text-muted">${reward}</p>
                    </div>
                </div>
            `;
        }

        function renderTabsAndCodes() {
            const grouped = groupCodesBySource();
            const tabs = document.getElementById("sourceTabs");
            const container = document.getElementById("codesContainer");

            tabs.innerHTML = "";
            let first = true;
            Object.keys(grouped).forEach(source => {
                const id = source.toLowerCase().replace(/\s+/g, "-");
                const li = document.createElement("li");
                li.className = "nav-item";
                li.innerHTML = `<a class="nav-link ${first ? 'active' : ''}" href="#" onclick="showCodes('${id}', this)">${source}</a>`;
                tabs.appendChild(li);

                const div = document.createElement("div");
                div.id = id;
                div.className = "tab-content row g-3 mt-2";
                if (!first) div.style.display = "none";
                grouped[source].forEach(code => {
                    div.innerHTML += createCodeCard(code.code, code.reward);
                });
                container.appendChild(div);

                first = false;
            });
        }

        function showCodes(id, el) {
            document.querySelectorAll(".tab-content").forEach(div => div.style.display = "none");
            document.querySelectorAll(".nav-link").forEach(link => link.classList.remove("active"));
            document.getElementById(id).style.display = "flex";
            el.classList.add("active");
        }

        window.onload = () => {
            const savedTheme = localStorage.getItem("theme") || "dark";
            document.documentElement.setAttribute("data-theme", savedTheme);
            applyTheme(savedTheme);
            renderTabsAndCodes();
        };
    </script>
</body>
</html>
